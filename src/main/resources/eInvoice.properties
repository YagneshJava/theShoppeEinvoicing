getEinvoicePendingList = select SalesInvoiceId, SalesInvoiceNo,FORMAT(SalesInvoiceDate,'dd/MM/yyyy') SalesInvoiceDate,SalesInvoiceType,round(isnull(Total,0),0) Total,b.CustFName CustFName from MstSalesInvoice a left join MstCustomer b on a.CustId=b.CustId 

getEinvoicePendingListCount = select count(*) from MstSalesInvoice a left join MstCustomer b on a.CustId=b.CustId 

getPendingInvoiceItemList = select b.ItemShortName as PrdDesc, b.isService as IsServc, b.HSNNo as HsnCd,b.ItemCode as Barcde, a.qty as Qty,ISNULL(a.freeQty,0) FreeQty,'NOS' as Unit, round(a.BaseAmount,0) UnitPrice,round((a.BaseAmount*a.qty),0) TotAmt, round(ISNULL(a.DiscountAmount,0),0) Discount,0 PreTaxVal, round(((ISNULL(a.BaseAmount,0)*a.qty)-ISNULL(a.DiscountAmount,0)),0) AssAmt, (ISNULL(a.vat,0)+ISNULL(a.AddTax,0)) GstRt, ISNULL(CstTaxAmount,0) IgstAmt, round(ISNULL(a.VatAmount,0),0) CgstAmt, round(ISNULL(a.AddTaxAmount,0),0) SgstAmt, ISNULL(a.Cess,0) CesRt, round(ISNULL(a.CessAmount,0),0) CesAmt, 0 CesNonAdvlAmt, 0 StateCesRt, 0 StateCesAmt, 0 StateCesNonAdvlAmt, 0 OthChrg, a.TotalAmount TotItemVal from  MstSalesInvoiceItemDetails a LEFT JOIN MstItem b   ON a.ItemId = b.ItemId LEFT JOIN MstSalesInvoice c on a.SalesInvoiceId = c.SalesInvoiceId WHERE a.SalesInvoiceId=?

getPendingInvoiceItemListCount = select count(*) from  MstSalesInvoiceItemDetails a LEFT JOIN MstItem b   ON a.ItemId = b.ItemId LEFT JOIN MstSalesInvoice c on a.SalesInvoiceId = c.SalesInvoiceId WHERE a.SalesInvoiceId=?

getCustomerDetails = SELECT b.GSTNo Gstin, CustFName LglNm, CustFName TrdNm, (select stateid from MstState where stateid = c.StateId) Pos, c.Address Addr1, c.Address Addr2,  PhoneNo Ph, EmailId Em, isnull(c.PinCode,0) Pin, (select stateid from MstState where stateid = c.StateId) Stcd FROM MstCustomer a left join MstCustomerDocInfo b on a.CustId=b.CustId Left join MstCustomer c on a.CustId=c.CustId where a.CustId=?;

getInvoiceValueDetails = select sum(round(ISNULL(DiscountAmount,0),0)) Discount, round(sum((ISNULL(BaseAmount,0)*qty) - ISNULL(DiscountAmount,0)),0) AssVal, sum(ISNULL(CstTaxAmount,0)) IgstVal, sum(round(ISNULL(a.VatAmount,0),0)) CgstVal, sum(round(ISNULL(a.AddTaxAmount,0),0)) SgstVal,  sum(round(ISNULL(a.CessAmount,0),0)) CesVal, sum(a.TotalAmount) TotInvVal from  MstSalesInvoiceItemDetails a  WHERE a.SalesInvoiceId=? GROUP BY a.SalesInvoiceId

getTranDtlsAndDocDetails = select round(isnull(OtherChargeAmount,0),0) OthChrg, round(isnull(RoundOff,0),0) RndOffAmt,SalesInvoiceType,SalesInvoiceNo,FORMAT(SalesInvoiceDate,'dd/MM/yyyy') SalesInvoiceDate,CustId from MstSalesInvoice where SalesInvoiceId=?