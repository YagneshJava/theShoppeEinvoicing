#getEinvoicePendingList = select '', SalesInvoiceId, SalesInvoiceNo,CONVERT(VARCHAR,SalesInvoiceDate,103) SalesInvoiceDate,SalesInvoiceType,round(isnull(Total,0),0) Total,b.CustFName CustFName,c.GSTNo CustGSTNo,  (select case when count(invoice_id) = 0   then 'N' else 'Y' end downloaded from MsteInvoiceFlag   where invoice_id = a.SalesInvoiceId) Downloaded  from MstSalesInvoice a left join MstCustomer b   on a.CustId=b.CustId  left join MstCustomerDocInfo c on c.CustId=b.CustId  where c.GSTNo is not null 
getEinvoicePendingList = select * from (select  ROW_NUMBER() OVER(order By SalesInvoiceDate) as rownum,SalesInvoiceId, SalesInvoiceNo,CONVERT(VARCHAR,SalesInvoiceDate,103) SalesInvoiceDate,SalesInvoiceType,round(isnull(Total,0),0) Total,b.CustFName CustFName,c.GSTNo CustGSTNo,  (select case when count(invoice_id) = 0   then 'N' else 'Y' end downloaded from MsteInvoiceFlag   where invoice_id = a.SalesInvoiceId) Downloaded  from MstSalesInvoice a left join MstCustomer b   on a.CustId=b.CustId  left join MstCustomerDocInfo c on c.CustId=b.CustId  where c.GSTNo is not null) as tab where tab.CustGSTNo is not null 

getEinvoicePendingListCount = select count(*) from (select  ROW_NUMBER() OVER(order By SalesInvoiceDate) as rownum,SalesInvoiceId, SalesInvoiceNo,CONVERT(VARCHAR,SalesInvoiceDate,103) SalesInvoiceDate,SalesInvoiceType,round(isnull(Total,0),0) Total,b.CustFName CustFName,c.GSTNo CustGSTNo,  (select case when count(invoice_id) = 0   then 'N' else 'Y' end downloaded from MsteInvoiceFlag   where invoice_id = a.SalesInvoiceId) Downloaded  from MstSalesInvoice a left join MstCustomer b   on a.CustId=b.CustId  left join MstCustomerDocInfo c on c.CustId=b.CustId  where c.GSTNo is not null) as tab where tab.CustGSTNo is not null 

getPendingInvoiceItemList = select b.ItemShortName as PrdDesc, b.isService as IsServc, b.HSNNo as HsnCd,b.ItemCode as Barcde, a.qty as Qty,ISNULL(a.freeQty,0) FreeQty,'NOS' as Unit, round(a.BaseAmount/a.Qty,3) UnitPrice,round(a.BaseAmount,2) TotAmt, round(ISNULL(a.DiscountAmount,0)*0,2) Discount,0 PreTaxVal, round(a.BaseAmount,2) AssAmt, (ISNULL(a.vat,0)+ISNULL(a.AddTax,0)+ISNULL(a.CstTax,0)) GstRt, round(ISNULL(CstTaxAmount,0),2) IgstAmt, round(ISNULL(a.VatAmount,0),2) CgstAmt, round(ISNULL(a.AddTaxAmount,0),2) SgstAmt, ISNULL(a.Cess,0) CesRt, round(ISNULL(a.CessAmount,0),2) CesAmt, 0 CesNonAdvlAmt, 0 StateCesRt, 0 StateCesAmt, 0 StateCesNonAdvlAmt, 0 OthChrg, round((round(a.BaseAmount,2)+  round(ISNULL(CstTaxAmount,0),2)+ round(ISNULL(a.VatAmount,0),2) + round(ISNULL(a.AddTaxAmount,0),2) +round(ISNULL(a.CessAmount,0),2) ),2) TotItemVal from  MstSalesInvoiceItemDetails a LEFT JOIN MstItem b   ON a.ItemId = b.ItemId LEFT JOIN MstSalesInvoice c on a.SalesInvoiceId = c.SalesInvoiceId WHERE a.SalesInvoiceId = ?

getPendingInvoiceItemListCount = select count(*) from  MstSalesInvoiceItemDetails a LEFT JOIN MstItem b   ON a.ItemId = b.ItemId LEFT JOIN MstSalesInvoice c on a.SalesInvoiceId = c.SalesInvoiceId WHERE a.SalesInvoiceId=?

getCustomerDetails = SELECT b.GSTNo Gstin, CustFName LglNm, CustFName TrdNm,a.Address custaddress, (select StateCode from MstState where stateid = c.StateId) Pos,(select CityName from MstCity where CityId = c.CityId) Loc, c.Address Addrone, c.Address Addrtwo, isnull(c.PinCode,0) Pin, (select StateCode from MstState where stateid = c.StateId) Stcd FROM MstCustomer a left join MstCustomerDocInfo b on a.CustId=b.CustId Left join MstCustomerAddressInfo c on a.CustId=c.CustId where a.CustId=?

getInvoiceValueDetails = select 0 Discount, round(sum(ISNULL(BaseAmount,0)),2) AssVal, sum(ISNULL(CstTaxAmount,0)) IgstVal, round(sum(ISNULL(a.VatAmount,0)),2) CgstVal, round(sum(ISNULL(a.AddTaxAmount,0)),2) SgstVal,  round(sum(ISNULL(a.CessAmount,0)),2) CesVal, round(sum(a.TotalAmount),2) TotInvVal from  MstSalesInvoiceItemDetails a  WHERE a.SalesInvoiceId=? GROUP BY a.SalesInvoiceId

getTranDtlsAndDocDetails = select round(isnull(OtherChargeAmount,0),2) OthChrg, round(isnull(RoundOff,0),2) RndOffAmt,SalesInvoiceType,SalesInvoiceNo,CONVERT(VARCHAR,SalesInvoiceDate,103) SalesInvoiceDate,CustId from MstSalesInvoice where SalesInvoiceId=?

saveInvoiceDownloadFlag = insert into MsteInvoiceFlag (invoice_id, download_date) values(?, ?)