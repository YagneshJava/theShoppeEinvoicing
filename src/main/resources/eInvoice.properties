getEinvoicePendingList = select SalesInvoiceId, SalesInvoiceNo,CONVERT(VARCHAR,SalesInvoiceDate,103) SalesInvoiceDate,SalesInvoiceType,round(isnull(Total,0),0) Total,b.CustFName CustFName,c.GSTNo CustGSTNo from MstSalesInvoice a left join MstCustomer b   on a.CustId=b.CustId  left join MstCustomerDocInfo c on c.CustId=b.CustId  where c.GSTNo is not null 

getEinvoicePendingListCount = select count(*) from MstSalesInvoice a left join MstCustomer b on a.CustId=b.CustId  left join MstCustomerDocInfo c on c.CustId=b.CustId  where c.GSTNo is not null 

getPendingInvoiceItemList = select b.ItemShortName as PrdDesc, b.isService as IsServc, b.HSNNo as HsnCd,b.ItemCode as Barcde, a.qty as Qty,ISNULL(a.freeQty,0) FreeQty,'NOS' as Unit, round(a.BaseAmount/a.Qty,0) UnitPrice,round(a.BaseAmount,0) TotAmt, round(ISNULL(a.DiscountAmount,0)*0,0) Discount,0 PreTaxVal, round(a.BaseAmount,0) AssAmt, (ISNULL(a.vat,0)+ISNULL(a.AddTax,0)) GstRt, ISNULL(CstTaxAmount,0) IgstAmt, round(ISNULL(a.VatAmount,0),0) CgstAmt, round(ISNULL(a.AddTaxAmount,0),0) SgstAmt, ISNULL(a.Cess,0) CesRt, round(ISNULL(a.CessAmount,0),0) CesAmt, 0 CesNonAdvlAmt, 0 StateCesRt, 0 StateCesAmt, 0 StateCesNonAdvlAmt, 0 OthChrg, a.TotalAmount TotItemVal from  MstSalesInvoiceItemDetails a LEFT JOIN MstItem b   ON a.ItemId = b.ItemId LEFT JOIN MstSalesInvoice c on a.SalesInvoiceId = c.SalesInvoiceId WHERE a.SalesInvoiceId = ?

getPendingInvoiceItemListCount = select count(*) from  MstSalesInvoiceItemDetails a LEFT JOIN MstItem b   ON a.ItemId = b.ItemId LEFT JOIN MstSalesInvoice c on a.SalesInvoiceId = c.SalesInvoiceId WHERE a.SalesInvoiceId=?

getCustomerDetails = SELECT b.GSTNo Gstin, CustFName LglNm, CustFName TrdNm, (select StateCode from MstState where stateid = c.StateId) Pos,(select CityName from MstCity where CityId = c.CityId) Loc, c.Address Addrone, c.Address Addrtwo, isnull(c.PinCode,0) Pin, (select StateCode from MstState where stateid = c.StateId) Stcd FROM MstCustomer a left join MstCustomerDocInfo b on a.CustId=b.CustId Left join MstCustomerAddressInfo c on a.CustId=c.CustId where a.CustId=?

getInvoiceValueDetails = select 0 Discount, round(sum(ISNULL(BaseAmount,0)),0) AssVal, sum(ISNULL(CstTaxAmount,0)) IgstVal, sum(round(ISNULL(a.VatAmount,0),0)) CgstVal, sum(round(ISNULL(a.AddTaxAmount,0),0)) SgstVal,  sum(round(ISNULL(a.CessAmount,0),0)) CesVal, round(sum(a.TotalAmount),0) TotInvVal from  MstSalesInvoiceItemDetails a  WHERE a.SalesInvoiceId=? GROUP BY a.SalesInvoiceId

getTranDtlsAndDocDetails = select round(isnull(OtherChargeAmount,0),0) OthChrg, round(isnull(RoundOff,0),0) RndOffAmt,SalesInvoiceType,SalesInvoiceNo,CONVERT(VARCHAR,SalesInvoiceDate,103) SalesInvoiceDate,CustId from MstSalesInvoice where SalesInvoiceId=?